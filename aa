--1. Tampilkan seluruh data Pegawai
select * from hr.employees;
select * from hr.jobs;

--2. Tampilkan Data pegawai yang pekerjaannya sebagai sales dan gajinya di atas 3000.
SELECT *
FROM hr.employees E join hr.jobs J
ON (E.job_id = J.job_id)
WHERE job_title LIKE '%Sales%'
  AND salary >3000;

--3. Tampilkan nama depan, nama belakang pegawai, gaji, dan gaji setelah di tambahkan dengan komisi.
SELECT first_name, last_name, salary, commission_pct, 
  NVL2(commission_pct,salary + (salary* commission_pct), salary) total_salary
FROM hr.employees;

--4. Tampilkan nama pegawai, pekerjaan dan tanggal mulai pegawai yang mulai bekerja setelah tanggal 1 February 2003. Urutkan berdasarkan tgl mulai kerja.
select first_name || ' ' || last_name as Nama_pegawai, job_title, hire_date
  from hr.employees e 
join hr.jobs j on (e.job_id = j.job_id)
  where hire_date > '01-FEB-03'
  order by hire_date;

--5. Tampilkan nama pegawai dan hitunglah berapa tahun pegawai tersebut telah bekerja hingga saat ini yang di beri judul "Lama Kerja(tahun)" kemudian urutkan bedasarkan lama kerja.
select  first_name || ' ' || last_name as Nama_pegawai, round((sysdate - hire_date)/365) as Lama_Kerja
  from hr.employees
  Order by Nama_pegawai, round((sysdate - hire_date)/365) ;

--6. Tampilkan nama lengkap pegawai dan email pegawai dengan mengganti huruf ke 3 pada email dengan '@'
select first_name || ' ' || last_name, email, REPLACE(email, (SUBSTR(email,3,1)), '@')
from hr.employees;

--7. Tampilkan nama pegawai (nama depan huruf kecil semua sedangkan nama belakang hanya huruf pertamanya besar) sebagai nama, pemnambahan gaji sebesar 20% sebagai Bonus kemudian di urutkan berdasarkan bonus
select  lower(first_name) || ' ' || initcap(last_name) as Nama, round (salary* 20/100) as Bonus, round (salary * 1.200) Total_salary
  from hr.employees
  order by round (salary* 20/100);

--8. Tampilkan nama belakang karyawan yang memiliki urutan abjad pertama dan yang terakhir.

--9. Tampilkan job id, departement id, dan selisih gaji yang lebih dari 5000
select j.job_id, d.department_id, (max_salary - min_salary)
From hr.employees e
JOIN hr.jobs j ON (e.job_id = j.job_id)
JOIN hr.departments d ON (d.department_id = e.department_id)
  WHERE (max_salary-min_salary) > 5000;

--10. Tampilkan jumlah pegawai yang memiliki 2 huruf depan email yang sama dan di urutkan berdasarkan abjad
select SUBSTR(email,1,2) as Email, count(employee_id) as JUMLAH_PEGAWAI
from hr.employees e
group by SUBSTR(email,1,2)
having count(employee_id) > 1 
order by SUBSTR(email,1,2);

Tampilkan jumlah dari provinsi yang merupakan negara "United States of America".
Tampilkan nama lengkap pegawai yang tinggal di kota Oxford
